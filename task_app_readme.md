# Task Management System

一個專為生成 Outlook 格式郵件的任務管理 Web 應用程式，支援完整的任務編輯、表格插入、圖片上傳和郵件格式匯出功能。

## 功能特色

### ✨ 主要功能
- **黃底區塊標題** - 完全符合您的 Outlook 郵件格式
- **任務管理** - 支援任務標題、負責人、截止日期、狀態、優先度
- **縮排一致** - 精確模擬 Outlook 的排版和間距
- **連結和文字顏色** - 支援超連結和彩色文字
- **自動編號** - 每個區塊的任務從 1 開始編號
- **拖拽排序** - 區塊和任務都可以調整位置

### 📊 進階功能
- **表格支援** - 動態新增/編輯表格，支援換色和格式調整
- **圖片管理** - 上傳圖片並可調整大小
- **即時預覽** - 即時預覽 Outlook 格式效果
- **多格式匯出** - 支援 HTML 和 MSG 格式匯出
- **數據持久化** - 自動儲存和載入工作進度

### 🎨 設計特色
- **北歐藍風格** - 乾淨簡約的現代化介面
- **響應式設計** - 支援各種螢幕尺寸
- **直觀操作** - 專注於 Outlook 郵件生成的用戶體驗

## 安裝步驟

### 1. 創建專案目錄結構
```
task_management_app/
├── app.py
├── templates/
│   └── index.html
├── static/
│   ├── css/
│   │   └── style.css
│   ├── js/
│   │   └── script.js
│   └── uploads/
└── requirements.txt
```

### 2. 安裝依賴套件

創建 `requirements.txt`：
```
Flask==2.3.2
```

安裝套件：
```bash
pip install -r requirements.txt
```

### 3. 運行應用程式
```bash
python app.py
```

應用程式將在 `http://localhost:5000` 啟動

## 使用指南

### 📝 基本操作

1. **新增區塊**
   - 點擊「新增區塊」按鈕
   - 輸入區塊標題（會顯示為黃底標題）

2. **新增任務**
   - 在區塊中點擊「新增任務」
   - 填寫任務資訊：
     - 標題：任務名稱
     - 負責人：如 "Vince/宇軒"
     - 截止日期：會顯示為 **[Due date: 0902]**
     - 狀態：如 **[Status: Pending]**
     - 優先度：如 **[Priority:1]**

3. **新增內容**
   - **項目**：點擊「新增項目」新增子項目
   - **表格**：點擊「新增表格」插入表格
   - **圖片**：點擊「新增圖片」上傳圖片

### 🔧 進階功能

#### 表格操作
- 點擊表格中的儲存格可直接編輯
- 使用「新增列」和「新增欄」擴展表格
- 「刪除表格」移除整個表格

#### 圖片管理
- 支援 JPG、PNG、GIF 等格式
- 可使用滑桿調整圖片寬度
- 上傳的圖片會儲存在 `static/uploads/` 目錄

#### 排序功能
- 使用上下箭頭按鈕調整區塊和任務順序
- 任務編號會自動重新排列

### 💾 儲存和匯出

#### 儲存功能
- 「儲存」：將當前資料儲存為 JSON 格式
- 「載入」：載入之前儲存的資料

#### 預覽功能
- 「預覽」：即時查看 Outlook 格式效果
- 完全符合您提供的郵件格式範例

#### 匯出功能
- **匯出 HTML**：產生標準 HTML 格式
- **匯出 MSG**：產生 Outlook 郵件格式 (.msg)

## 技術規格

### 後端
- **Flask** - Python Web 框架
- **JSON** - 資料儲存格式
- **Email/MIME** - MSG 格式生成

### 前端
- **HTML5** - 語義化標記
- **CSS3** - 北歐藍風格設計
- **JavaScript** - 互動功能和 DOM 操作
- **Font Awesome** - 圖示系統

### 格式相容性
- **Outlook 完全相容** - 精確模擬 Outlook 排版
- **HTML 標準** - 符合現代瀏覽器標準
- **響應式設計** - 支援各種設備

## 自訂設定

### 顏色主題
在 `style.css` 中的 `:root` 選擇器調整：
```css
:root {
    --primary-blue: #2E5266;    /* 主要藍色 */
    --secondary-blue: #52798B;   /* 次要藍色 */
    --light-blue: #A8CEDD;       /* 淺藍色 */
    --highlight-yellow: #FFFF00; /* 黃色標題背景 */
}
```

### 上傳限制
在 `app.py` 中調整：
```python
app.config['MAX_CONTENT_LENGTH'] = 16 * 1024 * 1024  # 16MB
```

## 疑難排解

### 常見問題

1. **圖片無法顯示**
   - 確認 `static/uploads/` 目錄存在且有寫入權限
   - 檢查圖片格式是否支援

2. **匯出 MSG 失敗**
   - 確認已安裝所有必要的 Python 套件
   - 檢查系統是否支援 MIME 格式

3. **預覽格式不正確**
   - 確認所有 CSS 檔案載入正常
   - 檢查瀏覽器 console 是否有錯誤訊息

### 效能優化

- 定期清理 `static/uploads/` 中的舊圖片
- 大型專案建議使用資料庫儲存資料
- 生產環境建議使用 WSGI 伺服器如 Gunicorn

## 授權資訊

本專案採用 MIT 授權條款。

---

**注意**：這個系統專門設計來符合您提供的 Outlook 郵件格式範例，包括黃底標題、任務編號、日期格式、狀態標示等所有細節。所有的排版和間距都經過精心調整以匹配 Outlook 的顯示效果。
